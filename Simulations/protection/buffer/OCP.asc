Version 4
SHEET 1 2764 1300
WIRE 0 128 -512 128
WIRE 144 128 96 128
WIRE 288 128 144 128
WIRE 528 128 288 128
WIRE 576 128 528 128
WIRE 1760 128 672 128
WIRE -512 144 -512 128
WIRE 528 144 528 128
WIRE 1760 160 1760 128
WIRE 144 176 144 128
WIRE 288 176 288 128
WIRE 1984 192 1936 192
WIRE 1872 208 1840 208
WIRE 2096 224 1936 224
WIRE 528 240 528 208
WIRE 2096 240 2096 224
WIRE 48 272 48 208
WIRE 144 272 144 240
WIRE 144 272 48 272
WIRE 48 320 48 272
WIRE 1984 320 1984 192
WIRE 1984 320 1680 320
WIRE 288 336 288 256
WIRE 528 336 528 304
WIRE 528 336 288 336
WIRE 624 336 624 208
WIRE 624 336 528 336
WIRE 912 336 912 304
WIRE 944 336 912 336
WIRE 1040 336 1024 336
WIRE 624 368 624 336
WIRE 2096 384 2096 320
WIRE 48 432 48 400
WIRE 624 464 624 448
WIRE 800 464 752 464
WIRE 912 464 912 336
WIRE 912 464 880 464
WIRE 1072 480 1008 480
WIRE 1104 480 1072 480
WIRE 912 496 912 464
WIRE 944 496 912 496
WIRE 1680 496 1680 320
WIRE 1680 496 1504 496
WIRE 2096 496 2096 464
WIRE 1040 512 1040 336
WIRE 1040 512 1008 512
WIRE 1312 512 1312 480
WIRE 1312 512 1040 512
WIRE 1440 512 1312 512
WIRE 1552 528 1504 528
WIRE 1680 528 1680 496
WIRE 752 544 752 464
WIRE 752 544 672 544
WIRE 1760 544 1760 256
WIRE 1760 544 1728 544
WIRE 624 608 624 560
WIRE 912 624 912 496
WIRE 1072 624 1072 480
WIRE 1552 640 1552 528
WIRE 1728 640 1728 592
WIRE 1760 640 1760 624
WIRE 1760 640 1728 640
WIRE 1760 656 1760 640
WIRE 1152 672 1136 672
WIRE 1152 704 1152 672
WIRE 912 720 912 704
WIRE 912 720 720 720
WIRE 1312 752 1312 512
WIRE 1424 816 1424 768
WIRE 1424 832 1424 816
WIRE 1424 832 1360 832
WIRE 1424 896 1424 832
WIRE 1152 1040 1152 784
WIRE 1152 1040 1088 1040
WIRE 1152 1056 1152 1040
WIRE 1152 1184 1152 1136
WIRE 1152 1280 1152 1264
FLAG -512 224 0
FLAG 624 608 0
FLAG 1760 656 0
FLAG 1680 608 0
FLAG -240 560 0
FLAG -352 560 0
FLAG -352 480 12V
FLAG -240 480 -12V
FLAG 1552 720 0
FLAG 1904 240 -12V
FLAG 1904 176 12V
FLAG 2096 496 0
FLAG 1472 480 12V
FLAG 1472 544 0
FLAG 1312 400 12V
FLAG 976 464 12V
FLAG 976 528 0
FLAG 912 224 12V
FLAG 1104 560 0
FLAG 1104 400 12V
FLAG 1072 720 0
FLAG 48 432 0
FLAG 912 784 0
FLAG 720 720 OCP_EVENT
FLAG 1088 1040 RST
FLAG 1152 1280 0
FLAG 1312 848 0
FLAG 1424 976 0
FLAG 1424 816 OCP_override
FLAG 1424 688 12V
SYMBOL EXTRA\\IRF\\PMOSFET\\irf9540n 624 128 R270
SYMATTR InstName U1
SYMBOL voltage -512 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE({Vin} {-Vin} 6m 1u 1u 1m 100m)
SYMBOL EXTRA\\IRF\\PMOSFET\\irf9540n 48 128 M270
SYMATTR InstName U2
SYMBOL EXTRA\\IRF\\NMOSFET\\irfz44n 1792 208 M0
SYMATTR InstName U3
SYMBOL voltage 2096 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 3 1.1m 900u 900u 1m 10m)
SYMBOL zener 160 240 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value KDZV16B
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 272 160 R0
SYMATTR InstName R1
SYMATTR Value {UR}
SYMBOL res 1744 528 R0
SYMATTR InstName R3
SYMATTR Value 0.1
SYMBOL e 1680 512 M0
SYMATTR InstName E1
SYMATTR Value 20
SYMBOL voltage -352 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 12
SYMBOL voltage -240 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value -12
SYMBOL voltage 1552 624 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 2
SYMBOL OpAmps\\UniversalOpAmp2 1904 208 M0
SYMATTR InstName U6
SYMATTR SpiceLine Ilimit=200m Rail=0 Vos=0
SYMBOL EXTRA\\ExtraComparators\\LM339A_TI 1472 512 M0
SYMATTR InstName U5
SYMBOL res 1296 384 R0
SYMATTR InstName R4
SYMATTR Value 20k
SYMBOL EXTRA\\ExtraComparators\\LM339A_TI 976 496 M0
SYMATTR InstName U4
SYMBOL res 928 352 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 896 208 R0
SYMATTR InstName R6
SYMATTR Value 2k
SYMBOL res 1088 384 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 1088 464 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL voltage 1152 1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value PULSE(0 3.3 0 1u 1u 1m 100m)
SYMBOL res 1136 688 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL npn 1136 624 M0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res 896 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL res 32 304 R0
SYMATTR InstName R11
SYMATTR Value 2k
SYMBOL zener 544 208 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value KDZV8_2B
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL zener 928 784 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value 1N749
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 896 608 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL voltage 2096 224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value PULSE(0 12 8m 1n 1n 1m 100m)
SYMBOL voltage 1152 1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PULSE(0 3.3 4m 1u 1u 1m 100m)
SYMBOL voltage 1424 880 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value 0
SYMBOL nmos 672 464 M0
SYMATTR InstName M2
SYMATTR Value 2N7002
SYMBOL res 608 352 R0
SYMATTR InstName R2
SYMATTR Value {DR}
SYMBOL zener 544 304 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value KDZV8_2B
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 1408 672 R0
SYMATTR InstName R13
SYMATTR Value 20k
SYMBOL nmos 1360 752 M0
SYMATTR InstName M1
SYMATTR Value 2N7002
TEXT -384 760 Left 2 !.tran 10m
TEXT 344 -96 Left 2 ;.step param UR list 1k 2k 3k 4k
TEXT 352 -144 Left 2 !.param UR=2k Ratio=7 DR=300
TEXT 344 0 Left 2 ;.step param Ratio list 7  10 13
TEXT -528 8 Left 2 !.param Vin=30
TEXT 1040 -120 Left 2 ;4 Rst on\n5 rst off\n6 -DUT\n7 +DUT\n8 Current step
